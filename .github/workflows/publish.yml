name: Publish package
on:
    release:
        types: [ created ]

jobs:
    publish:
        runs-on: ubuntu-latest
        steps:
            -   uses: actions/checkout@v3
            -   uses: actions/setup-node@v3
                with:
                    node-version: 18
                    registry-url: 'https://registry.npmjs.org/'
            -   run: npm ci
            -   run: npm version ${{ github.event.release.tag_name }} --workspaces
            -   run: npm run build --workspaces
            -   run: npm publish --access public --workspaces
                env:
                    NODE_AUTH_TOKEN: ${{secrets.NODE_AUTH_TOKEN}}
            -   run: git config --global user.email bot@easy-breezy.com
            -   run: git config --global user.name bot
            -   run: git push
            -   run: git push --tags
